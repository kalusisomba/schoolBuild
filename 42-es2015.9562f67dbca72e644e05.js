(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{Olgc:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i("fXoL"),n=i("7zfz");let a=(()=>{class t{constructor(t){this.messageService=t}addSingle(t,e,i){this.messageService.add({severity:t,summary:e,detail:i})}addMultiple(t){this.messageService.addAll(t)}clear(){this.messageService.clear()}}return t.\u0275fac=function(e){return new(e||t)(r.Zb(n.d))},t.\u0275prov=r.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},UAnn:function(t,e,i){"use strict";i.r(e);var r=i("ofXK"),n=i("tyNb"),a=i("7zfz"),s=i("J7/z"),o=i("AlMu"),c=i("Olgc"),l=i("5JmO"),d=i.n(l),p=i("TruH"),b=i.n(p),u=i("uIk+"),h=i("fXoL");d.a.vfs=b.a.pdfMake.vfs;let g=(()=>{class t{constructor(t){this.canvas=t}setTitle(t,e,i,r,n,a,s){let o,c;return"A6"===s?(o=[15,10,0,10],c=8):(o=[15,10,0,10],c=10),[{table:{widths:["100%","0%"],body:[[{image:t,alignment:"center",width:60,height:30}],[{text:e,fontSize:c,alignment:"center",bold:!0}],[{text:i,fontSize:c,alignment:"center"}],[{text:r,fontSize:c,alignment:"center",italics:!0}],[{text:n,fontSize:c,alignment:"center",italics:!0}]]},layout:"noBorders"}]}createTableHeader(t){const e={fila_0:{}};return t.forEach((t,i)=>{e.fila_0["col_"+(+i+1)]={text:t,style:"tableHeader",margin:[0,8,0,0]}}),e}createBody(t,e){const i=[];for(const r in t){const e=[];for(const i in t[r])e.push(t[r][i]);i.push(e)}return e.forEach(t=>{const e=[];for(const i in t)e.push(t[i]);i.push(e)}),i}getDocDefinition(t,e,i,r,n,a,s,o,c,l){const d={header:{title:t,header1:e,header2:i,header3:r},body:{header:a,record:s}},p=this.createBody(this.createTableHeader(d.body.header),d.body.record);let b,u,h;return"A6"===l?(b=[10,110,10,55],u=10,h=7):(u=16,h=10,b=[10,110,10,55]),{pageOrientation:o,pageSize:l,pageMargins:b,header:this.setTitle(n,t,e,i,r,d,l),footer:(t,e)=>({text:"Page "+t.toString()+" of "+e,alignment:"center",margin:[0,30,0,0]}),content:[{style:"tableContent",table:{widths:c,headerRows:1,body:p}}],styles:{header:{fontSize:u,bold:!0},tableHeader:{bold:!0},tableContent:{fontSize:h}}}}generatePdf(t){d.a.createPdf(t).print()}getPdfData(t){const e=["50%","50%"],i=["Stream Name","Stream Code"],r=`Date: ${(new Date).toLocaleString()}`;this.canvas.getBase64Image("./assets/images/schoollogo.jpg").then(n=>{this.generatePdf(this.getDocDefinition("ST. FRANCIS OF ASSISI SECONDARY SCHOOL - KALIINI","P.O BOX 30-90121 - Emali","Tel. No.:072127703",r,n,i,this.mapData(t),"portrait",e,"A4"))})}mapData(t){return t.map(t=>({Name:t.streamName,Code:t.streamCode}))}}return t.\u0275fac=function(e){return new(e||t)(h.Zb(u.a))},t.\u0275prov=h.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var m=i("7qeh"),f=i("75Oz"),S=i("24YL"),v=i("7CaW"),C=i("rEr+"),w=i("3Pt+"),O=i("7kUa");function y(t,e){if(1&t&&(h.Vb(0,"th"),h.Ic(1),h.Ub()),2&t){const t=e.$implicit;h.Db(1),h.Kc(" ",t.header," ")}}function U(t,e){if(1&t&&(h.Vb(0,"tr",11),h.Gc(1,y,2,1,"th",12),h.Vb(2,"th"),h.Ic(3,"Class"),h.Ub(),h.Vb(4,"th"),h.Ic(5,"Action"),h.Ub(),h.Ub()),2&t){const t=h.gc();h.Db(1),h.nc("ngForOf",t.columns)}}function I(t,e){if(1&t&&(h.Vb(0,"td"),h.Vb(1,"div"),h.Ic(2),h.Ub(),h.Ub()),2&t){const t=e.$implicit,i=h.gc().$implicit;h.Db(2),h.Jc(i[t.field])}}const A=function(t){return["/main/streams/","stream-details",t]},D=function(t){return["/main/streams/","stream-edit",t]};function P(t,e){if(1&t){const t=h.Wb();h.Vb(0,"tr",11),h.Gc(1,I,3,1,"td",12),h.Vb(2,"td"),h.Ic(3),h.Ub(),h.Vb(4,"td"),h.Vb(5,"div",13),h.Vb(6,"button",14),h.Ic(7,"View"),h.Ub(),h.Vb(8,"button",15),h.Ic(9,"Edit"),h.Ub(),h.Vb(10,"button",16),h.dc("click",(function(){h.zc(t);const i=e.$implicit;return h.gc().deleteStream(i._id)})),h.Ic(11,"Delete"),h.Ub(),h.Ub(),h.Ub(),h.Ub()}if(2&t){const t=e.$implicit,i=h.gc();h.Db(1),h.nc("ngForOf",i.columns),h.Db(2),h.Jc(t.unitID.unitName),h.Db(3),h.nc("routerLink",h.qc(4,A,t._id)),h.Db(2),h.nc("routerLink",h.qc(6,D,t._id))}}const R=[{path:"",component:(()=>{class t{constructor(t,e,i,r,n){this.dialogService=t,this.toastService=e,this.applicationStateService=i,this.streamsService=r,this.pdfService=n,this.streams=[],this.isMobileResolution=!1}ngOnInit(){this.isMobileResolution=this.applicationStateService.getIsMobileResolution(),this.pageSize=10,this.columns=[{field:"streamName",header:"Name"},{field:"streamCode",header:"Code"}],this.getStreams()}getStreams(){this.streamsService.getStreams().subscribe(t=>{this.streams=t.data,this.toastService.addSingle("success","Streams Loaded","")},t=>{this.toastService.addSingle("error","sorry, we could not find the data","contact the admin for assitance")})}openNew(){this.dialogService.open(m.a,{data:{},header:"Add New Stream",width:this.isMobileResolution?"400px":"600px"}).onClose.subscribe(t=>{t&&this.toastService.addSingle("success","panel closed","")})}exportPdf(){this.pdfService.getPdfData(this.streams)}}return t.\u0275fac=function(e){return new(e||t)(h.Pb(s.a),h.Pb(c.a),h.Pb(o.a),h.Pb(f.a),h.Pb(g))},t.\u0275cmp=h.Jb({type:t,selectors:[["app-stream-list"]],features:[h.Cb([s.a,a.d,a.a])],decls:16,vars:5,consts:[["pRipple","",1,"btn","btn-success","btn-sm","m-1",3,"click"],["pRipple","","type","button","icon","pi pi-file-excel","tooltipPosition","bottom",1,"btn","btn-info","btn-sm","mx-2",3,"click"],["header","Streams"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],[1,"ui-g"],[1,"ui-g-10","ui-sm-8"],[2,"float","right"],[1,"ui-g-2","ui-sm-4"],["type","text","pInputText","",3,"ngModel","ngModelChange"],[1,"text-sm"],[4,"ngFor","ngForOf"],[1,"flex"],["pRipple","",1,"btn","btn-info","btn-sm",2,"margin-right","16px",3,"routerLink"],["pRipple","",1,"btn","btn-primary","btn-sm",2,"margin-right","16px",3,"routerLink"],["pRipple","",1,"btn","btn-danger","btn-sm",3,"click"]],template:function(t,e){1&t&&(h.Qb(0,"app-header-breadcrumb"),h.Vb(1,"div"),h.Vb(2,"button",0),h.dc("click",(function(){return e.openNew()})),h.Ic(3,"Create New Stream"),h.Ub(),h.Vb(4,"button",1),h.dc("click",(function(){return e.exportPdf()})),h.Ic(5,"Stream report"),h.Ub(),h.Ub(),h.Vb(6,"p-panel",2),h.Vb(7,"p-table",3),h.Gc(8,U,6,1,"ng-template",4),h.Gc(9,P,12,8,"ng-template",5),h.Ub(),h.Vb(10,"div",6),h.Vb(11,"div",7),h.Vb(12,"label",8),h.Ic(13,"Page Size:"),h.Ub(),h.Ub(),h.Vb(14,"div",9),h.Vb(15,"input",10),h.dc("ngModelChange",(function(t){return e.pageSize=t})),h.Ub(),h.Ub(),h.Ub(),h.Ub()),2&t&&(h.Db(7),h.nc("value",e.streams)("paginator",!0)("rows",e.pageSize)("showCurrentPageReport",!0),h.Db(8),h.nc("ngModel",e.pageSize))},directives:[S.a,v.a,C.c,a.e,w.b,O.a,w.k,w.n,r.j,n.d],styles:[""]}),t})()}];let V=(()=>{class t{}return t.\u0275mod=h.Nb({type:t}),t.\u0275inj=h.Mb({factory:function(e){return new(e||t)},imports:[[n.g.forChild(R)],n.g]}),t})();var L=i("EQGD"),z=i("K0h9");i.d(e,"StreamListModule",(function(){return k}));let k=(()=>{class t{}return t.\u0275mod=h.Nb({type:t}),t.\u0275inj=h.Mb({factory:function(e){return new(e||t)},imports:[[r.b,V,L.a,z.a]]}),t})()},xHgC:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var r=i("tk/3"),n=i("z6cu"),a=i("JIr8"),s=i("AytR"),o=i("fXoL");let c=(()=>{class t{constructor(t){this.httpClient=t,this.apiURL=s.a.apiUrl,this.httpOptions={headers:new r.c({"Content-Type":"application/json","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Origin":"*","Cross-Origin":"true","Access-Control-Allow-Methods":"GET, POST, PATCH, DELETE, PUT, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With",Authorization:"Bearer "+localStorage.getItem("jwt")})}}getClasses(){return this.httpClient.get(this.apiURL+"/units/getallunits",this.httpOptions).pipe(Object(a.a)(this.errorHandler))}getClass(t){return this.httpClient.get(`${this.apiURL}/units/getunit/${t}`,this.httpOptions).pipe(Object(a.a)(this.errorHandler))}createClass(t){return this.httpClient.post(`${this.apiURL}/units/registerunit`,JSON.stringify(t),this.httpOptions).pipe(Object(a.a)(this.errorHandler))}updateClass(t,e){return this.httpClient.patch(`${this.apiURL}/units/updateunit`,JSON.stringify(e),this.httpOptions).pipe(Object(a.a)(this.errorHandler))}deleteClass(t){return this.httpClient.delete(`${this.apiURL}/units/archive/${t}`,this.httpOptions).pipe(Object(a.a)(this.errorHandler))}errorHandler(t){let e="";return t.error instanceof ErrorEvent?(e=t.error.message,console.log("Client Side Error",e)):(e=`Server Side Error Code: ${t.status}\n Message: ${t.message}`,console.log(e)),Object(n.a)(console.log(e))}}return t.\u0275fac=function(e){return new(e||t)(o.Zb(r.a))},t.\u0275prov=o.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);